         TITLE 'DYNAMIC ALLOCATION INTERFACE'                               1.
*                                                                           2.
*   CREATE A VERB TABLE ENTRY                                               3.
*                                                                           4.
         MACRO                                                              5.
         VENT  &VERB,&NUMBER                                                6.
         LCLA  &LABEL                                                       7.
&LABEL   SETA  &SYSNDX                                                      8.
         DC    AL1(L'#&LABEL)                                               9.
         DC    AL1(&NUMBER)                                                10.
#&LABEL  DC    C'&VERB'                                                    11.
         MEND                                                              12.
         SPACE 3                                                           13.
*                                                                          14.
*   CREATE A KEYWORD TABLE ENTRY                                           15.
*   &KEYWORD  - THE DYNAM KEYWORD                                          16.
*   &UAL      - THE DYNAM KEYWORD UNAMBIGOUS LENGTH                        17.
*   &KEY      - THE SVC99 TEXT UNIT KEY                                    18.
*   &PARM     - THE SVC99 TEXT UNIT PARM                                   19.
*   &PARMLEN  - THE SVC99 TEXT UNIT PARM LENGTH                            20.
*                                                                          21.
         MACRO                                                             22.
         KENT  &KEYWORD,&UAL,&KEY,&PARM,&PARMLEN                           23.
         GBLA  &OFFSET                                                     24.
         LCLA  &LABEL                                                      25.
         LCLC  &LEN                                                        26.
&LEN     SETC  '0'                                                         27.
&LABEL   SETA  &SYSNDX                                                     28.
         DC    AL1(L'#&LABEL)                                              29.
         DC    X'&UAL'                                                     30.
         AIF   (T'&PARM EQ 'O').NOPARM                                     31.
         AIF   ('&PARM' NE 'SUBTABLE').KENT003                             32.
         DC    AL1(&OFFSET+240)                                            33.
&OFFSET  SETA  &OFFSET+1                                                   34.
&LEN     SETC  '1'                                                         35.
         AGO   .KENT001                                                    36.
.KENT003 ANOP                                                              37.
         DC    X'&PARM'                                                    38.
&LEN     SETC  '1'                                                         39.
         AGO   .KENT001                                                    40.
.NOPARM  ANOP                                                              41.
         DC    AL1(0)                                                      42.
.KENT001 ANOP                                                              43.
         AIF   (T'&PARMLEN EQ 'O').KENT002                                 44.
&LEN     SETC  '&PARMLEN'                                                  45.
.KENT002 ANOP                                                              46.
         DC    AL1(&LEN)                                                   47.
         DC    AL2(&KEY)                                                   48.
#&LABEL  DC    C'&KEYWORD'                                                 49.
         MEND                                                              50.
         EJECT                                                             51.
*                                                                          52.
*   CREATE A KEYWORD HASH TABLE ENTRY                                      53.
*                                                                          54.
         MACRO                                                             55.
         BEGIN &CHAR                                                       56.
BEGIN&CHAR DS  0X                                                          57.
         MEND                                                              58.
         SPACE 3                                                           59.
*                                                                          60.
*   CREATE THE KEYWORD TABLE HASH INDEX                                    61.
*                                                                          62.
         MACRO                                                             63.
         INDEX                                                             64.
KYWDINDX DS    0F                 ALIGN ON FULLWORD BOUNDARY               65.
         DC    A(BEGINA)                                                   66.
         DC    A(BEGINB)                                                   67.
         DC    A(BEGINC)                                                   68.
         DC    A(BEGIND)                                                   69.
         DC    A(BEGINE)                                                   70.
         DC    A(BEGINF)                                                   71.
         DC    A(BEGING)                                                   72.
         DC    A(BEGINH)                                                   73.
         DC    A(BEGINI)                                                   74.
         DC    7A(0)                                                       75.
         DC    A(BEGINJ)                                                   76.
         DC    A(BEGINK)                                                   77.
         DC    A(BEGINL)                                                   78.
         DC    A(BEGINM)                                                   79.
         DC    A(BEGINN)                                                   80.
         DC    A(BEGINO)                                                   81.
         DC    A(BEGINP)                                                   82.
         DC    A(BEGINQ)                                                   83.
         DC    A(BEGINR)                                                   84.
         DC    8A(0)                                                       85.
         DC    A(BEGINS)                                                   86.
         DC    A(BEGINT)                                                   87.
         DC    A(BEGINU)                                                   88.
         DC    A(BEGINV)                                                   89.
         DC    A(BEGINW)                                                   90.
         DC    A(BEGINX)                                                   91.
         DC    A(BEGINY)                                                   92.
         DC    A(BEGINZ)                                                   93.
         MEND                                                              94.
         EJECT                                                             95.
*                                                                          96.
*   BEGIN A NEW SUBTABLE                                                   97.
*   SET COUNT OF # OF ENTRIES FOR PREVIOUS SUBTABLE                        98.
*   REMEMBER ENTRY POINT                                                   99.
*                                                                         100.
         MACRO                                                            101.
         BEGINSUB                 &SUBNAME                                102.
         GBLC  &SUBLIST(30)       LIST OF SUBTABLE ENTRIES                103.
         GBLA  &SUBCT(30)         LIST OF SUBTABLE ENTRY COUNTS           104.
         GBLA  &SUBINDX           CURRENT SUBTABLE                        105.
         GBLA  &SUBSENT           # ENTRIES IN CURRENT SUBTABLE           106.
         AIF   (&SUBINDX EQ 0).SUB0001 FIRST INVOCATION                   107.
&SUBCT(&SUBINDX) SETA &SUBSENT                                            108.
&SUBSENT SETA  0                                                          109.
.SUB0001 ANOP                                                             110.
&SUBINDX SETA  &SUBINDX+1                                                 111.
&SUBLIST(&SUBINDX) SETC '&SUBNAME'                                        112.
&SUBNAME DS    0X                                                         113.
         MEND                                                             114.
         SPACE 3                                                          115.
*                                                                         116.
*   ADD LAST SUBTABLE DEFINITION TO SUBTABLE LIST                         117.
*                                                                         118.
         MACRO                                                            119.
         ENDSUB                                                           120.
         GBLA  &SUBCT(30)                                                 121.
         GBLA  &SUBINDX                                                   122.
         GBLA  &SUBSENT                                                   123.
&SUBCT(&SUBINDX) SETA &SUBSENT                                            124.
         MEND                                                             125.
         EJECT                                                            126.
*                                                                         127.
*       GENERATE THE INDEX FOR ALL SUBTABLES                              128.
*                                                                         129.
         MACRO                                                            130.
&LABEL   SUBINDEX                                                         131.
         GBLC  &SUBLIST(30)                                               132.
         GBLA  &SUBCT(30)                                                 133.
         GBLA  &SUBINDX                                                   134.
         LCLA  &X                                                         135.
         AIF   (&SUBINDX LE 15).NOERR                                     136.
         MNOTE 16,'ONLY 16 SUBTABLES PERMITTED'                           137.
.NOERR   ANOP                                                             138.
&LABEL   DS    0F                                                         139.
.LOOP    ANOP                                                             140.
         AIF   (&X EQ &SUBINDX).#1                                        141.
&X       SETA  &X+1                                                       142.
         DC    AL1(&SUBCT(&X)),AL3(&SUBLIST(&X))                          143.
         AGO   .LOOP                                                      144.
.#1      ANOP                                                             145.
         MEND                                                             146.
         SPACE 3                                                          147.
*                                                                         148.
*   BUILD AN ENTRY IN A SUBTABLE                                          149.
*                                                                         150.
         MACRO                                                            151.
         SENT  &KEY,&VALUE                                                152.
         GBLA  &SUBSENT                                                   153.
         LCLA  &LABEL                                                     154.
&SUBSENT SETA  &SUBSENT+1                                                 155.
&LABEL   SETA  &SYSNDX                                                    156.
         DC    AL1(L'#&LABEL)                                             157.
         DC    XL2'&VALUE'                                                158.
#&LABEL  DC    C'&KEY'                                                    159.
         MEND                                                             160.
         EJECT                                                            161.
*                                                                         162.
*   BUILD A TABLE USED TO BUILD A DICB                                    163.
*                                                                         164.
         MACRO                                                            165.
&LABEL   DICBTAB1                                                         166.
&LABEL   DS    0H                                                         167.
         DC    X'000400010008',XL8'00' DDNAME                             168.
         DC    X'00050001002C',XL44'00' DSNAME                            169.
         DC    X'000600010008',XL8'00' MEMBER NAME                        170.
         DC    X'000700010001',X'00' STATUS                               171.
         DC    X'000800010001',X'00' DISPOSITION                          172.
         DC    X'000900010001',X'00'  CONDITIONAL DISPOSITION             173.
         DC    X'000A00010002',XL2'00' DSORG                              174.
         DC    X'000B00010002',XL2'00' LIMIT SPECIFICATION                175.
         DC    X'000C00010001',X'00' ATTRIBUTE SPECIFICATION              176.
         DC    X'000D00010001',X'00' LAST ENTRY SPECIFICATION             177.
         DC    X'000E00010001',X'00' DATA SET TYPE                        178.
         MEND                                                             179.
         MACRO                                                            180.
&LABEL   DICBTAB2                                                         181.
&LABEL   DS    0H                                                         182.
         DC    X'005500010008',XL8'00' DDNAME                             183.
         DC    X'00560001002C',XL44'00' DSNAME                            184.
         DC    X'005700010002',XL2'00' DSORG                              185.
         DC    X'005D00010006',XL6'00' VOLSER                             186.
         MEND                                                             187.
         EJECT                                                            188.
***********************************************************************   189.
*                                                                         190.
*   THIS ROUTINE PROVIDES AN INTERFACE BETWEEN A HIGH LEVEL               191.
*   LANGUAGE SUCH AS FORTRAN, PL/1 OR COBOL, AND THE OPERATING            192.
*   SYSTEM DYNAMIC ALLOCATION ROUTINES.                                   193.
*                                                                         194.
*   INSTALLATION: UNIVERSITY OF MANITOBA COMPUTER CENTRE                  195.
*   AUTHOR:       GERRY DUECK                                             196.
*   DATE WRITTEN: SUMMER 1978                                             197.
*   MODS:         ADDITION OF ALLOCR VERB.                                198.
*                 LOTS OF MUCKING ABOUT TO MAKE THIS PROGRAM              198.1
*                 CONSISTENT WITH ITS DOCUMENATION.                       198.2
*                   ROD ZAZUBEK FEB 1979                                  199.
*   DOCUMENTATION: COMPLETE DOCUMENTATION ON THE USE OF DYNAM IS          199.1
*                  AVAILABLE IN SYS4.DOCUMENT.TEXT(DYNAM)                 199.2
*   ATTRIBUTES:   RENT                                                    199.3
*   HINTS:        PUT THIS PROGRAM SOMEWHERE IN THE LINK LIST.            199.4
*                                                                         200.
*   PARAMETERS                                                            201.
*      1 - WORK AREA. THE FIRST WORD OF THIS WORK AREA MUST CONTAIN       202.
*          THE LENGTH OF THE AREA. A MINIMUM OF 100 BYTES IS REQUIRED.    203.
*          IF THE LENGTH IS ZERO, AND 'INIT' IS NOT SPECIFIED (SEE        204.
*          PARM 2) THEN A WORK AREA IS OBTAINED AND USED FOR THIS         205.
*          CALL ONLY. THE WORKAREA IS FREED BEFORE RETURNING TO THE       206.
*          CALLER.                                                        207.
*      2 - REQUEST VERB. THIS FIELD IS DELIMITED BY A BLANK.              208.
*          IF THE REQUEST VERB IS 'INIT' THEN ALL THIS CALL               209.
*          DOES IS TO ALLOCATE A WORK AREA FOR SUBSEQUENT                 210.
*          CALLS. IF THE VERB IS 'END' THEN THIS WORK AREA                211.
*          IS FREED.                                                      212.
*      3 AND SUBSEQUENT PARAMETERS.                                       213.
*        - CHARACTER STRINGS CONSISTING OF KEYWORD/VALUE PAIRS            214.
*          SEPARATED BY '=' AND DELIMITED BY ' ', ';'.                    215.
*          END OF STRING IS DETERMINED BY ';'                             216.
*          END OF LIST IS INDICATED BY THE HIGH ORDER BIT OF              217.
*          THE PARAMETER ADDRESS.                                         218.
*      AT LEAST 3 PARAMETERS ARE ASSUMED FOR ALL VERBS OTHER THAN         219.
*      'INIT' AND 'END'                                                   220.
*                                                                         221.
*   WORK AREA.                                                            222.
*      THE WORK AREA CONTAINS 5 SECTIONS:                                 223.
*         - WORK AREA CONTROL BLOCK.                                      224.
*         - DAIRFAIL PARAMETER LIST.                                      225.
*         - DYNAMIC ALLOCATION REQUEST BLOCK.                             226.
*         - TEXT UNITS.                                                   227.
*         - TEXT POINTERS.                                                228.
*      THE TEXT POINTERS ARE STACKED AT THE BOTTOM OF THE WORK AREA.      229.
*      THE TEXT UNITS ARE HEAPED AFTER THE REQUEST BLOCK.                 230.
*                                                                         231.
*  ENTRY OPTIONS:                                                         232.
*     IF VERB = 'INIT' THEN                                               233.
*        GET WORK AREA                                                    234.
*        PLACE ADDRESS IN PARM 1                                          235.
*        SET FIRST BYTE OF PARM 1 TO X'0F' TO INDICATE                    236.
*           THAT THIS IS A GETMAINED AREA                                 237.
*        RETURN                                                           238.
*     ELSE IF VERB = 'END' THEN                                           239.
*        FREE THE AREA POINTED TO BY PARM ONE                             240.
*        RETURN                                                           241.
*     ELSE IF PARM 1 = 0 THEN                                             242.
*        GETMAIN AREA                                                     243.
*        PERFORM ALLOCATION                                               244.
*        FREMAIN AREA                                                     245.
*        RETURN                                                           246.
*     ELSE IF HIGH ORDER BYTE OF PARM 1 IS X'0F' THEN                     247.
*        DEREFENCE WORK AREA POINTER                                      248.
*        PERFORM COMMAND                                                  249.
*     ELSE                                                                250.
*        PERFORM COMMAND USING USER SUPPLIED WORK AREA                    251.
*                                                                         252.
*   THREE TABLES ARE USED TO BUILD TEXT UNITS FOR SVC99.                  253.
*                                                                         254.
*   VERB TABLE:                                                           255.
*      THERE ARE ONLY 7 VERBS USED BY SVC99, AND SINCE SOME OF            256.
*      THESE ARE INFORMATION VERBS (IE THEY RETURN INFO) THEY ARE         257.
*      NOT SUPPORTED BY THIS INTERFACE SINCE THERE IS NO TRIVIAL          258.
*      MEANS OF RETURNING INFORMATION TO THE CALLER. THE VERB MUST        259.
*      BE AT LEAST AS LONG AS THE LENGTH SPECIFIED IN ITS CORRESONDING    260.
*      TABLE ENTRY. ACCESS TO THIS TABLE IS BY LINEAR SEARCH AND THE      261.
*      RESULT IS A ONE BYTE FIELD CONTAINING THE VERB CODE. TABLE         262.
*      ENTRIES ARE OF VARIABLE LENGTH WITH THE FIRST BYTE CONTAINING      263.
*      THE LENGTH OF THE VARIABLE PART. THE LENGTH OVERHEAD IS 2.         264.
*                                                                         265.
*   KEYWORD TABLE:                                                        266.
*      THE KEYWORD TABLE IS VERY LONG, AND THE ENTRIES ARE VARIABLE       267.
*      LENGTH SO A BINARY SEARCH IS OUT OF THE QUESTION (UNLESS YOU       268.
*      HAD A TAG POINTING TO EACH TABLE ENTRY -- HMMMMM...) AND A         269.
*      LINEAR SEARCH IS TOO SLOW. A PRIMITIVE HASH TABLE IS USED          270.
*      IN WHICH THERE IS AN ENTRY FOR EVERY LETTER AND A POINTER          271.
*      TO THE FIRST KEYWORD TABLE ENTRY WHOSE KEYWORD STARTS WITH         272.
*      THAT LETTER. THE KEYWORD TABLE IS SORTED ALPHABETICALLY            273.
*      AND THE HASH TABLE IS BUILT BY INSERTING A BEGIN MACRO             274.
*      EVERY TIME A CHANGE IN FIRST LETTER OCCURS. WHEN PERFORMING        275.
*      A SEARCH ON THIS TABLE, COMPARISONS ARE MADE TO THE LENGTH         276.
*      OF THE KEYWORD SPECIFIED BY THE USER. WHEN A MATCH IS FOUND,       277.
*      THE LENGTH OF THE KEYWORD IS COMPARED TO THE MINIMUM LENGTH        278.
*      SPECIFIED IN THE TABLE ENTRY. IT MUST BE AT LEAST THIS LONG        279.
*      IN ORDER TO BE UNAMBIGOUS.                                         280.
*                                                                         281.
*   KEYWORD SUBTABLE:                                                     282.
*     SOME OF THE ENTRIES IN THE KEYWORD TABLE REQUIRE MORE INFORMATION   283.
*      AND FOR THESE A POINTER TO A SUBTABLE IS SUPPLIED. THIS POINTER    284.
*      IS AN INDEX INTO ANOTHER TABLE MUCH LIKE THE HASH TABLE AND IS     285.
*      ONLY ONE BYTE, SO ONLY 16 SUBTABLES CAN OCCUR.                     286.
*                                                                         287.
*   BUILDING A TEXT UNIT:                                                 288.
*      AFTER FINDING THE KEYWORD IN THE KEYWORD TABLE, A VARIETY          289.
*      OF EVENTS CAN OCCUR. THIS IS BECAUSE IBM IN ITS INFINITE           290.
*      WISDOM CANNOT DECIDE ON A SIMPLE STRUCTURE FOR TEXT UNITS.         291.
*      SOME HAVE PARAMETERS THAT ARE PLI TYPE CHAR VAR, SOME ARE          292.
*      VARIABLE LENGTH BINARY VALUES, SOME HAVE NO PARAMETERS, ETC.       293.
*      THE FOLLOWING ALGORITHM IS USED TO BUILD THE TEXT UNIT:            294.
*                                                                         295.
*      IF THE USER SUPPLIED A PARM THEN                                   296.
*         IF A NON ZERO LENGTH IS SPECIFIED IN THE KEYWORD TABLE THEN     297.
*            CREATE A TEXT UNIT WITH A VARIABLE LENGTH BINARY VALUE       298.
*         ELSE                                                            299.
*            CREATE A TEXT UNIT WITH A VARIABLE LENGTH STRING VALUE       300.
*      ELIF THE PARM VALUE SUPPLIED IN THE KEYWORD TABLE IS >= X'F0'      301.
*         CREATE A TEXT UNIT USING THE LENGTH AND VALUE SUPPLIED          302.
*         IN THE SUBTABLE ENTRY CORRESSPONDING TO THE USER SUPPLIED       303.
*         VALUE                                                           304.
*      ELSE                                                               305.
*         CREATE A TEXT UNIT USING A LENGTH OF 1 AND THE VALUE            306.
*         SUPPLIED IN THE KEYWORD TABLE                                   307.
*                                                                         308.
*      THIS ALGORITHM WORKS WELL ENOUGH EXCEPT FOR TWO KLUGES:            309.
*      CONCATENATION AND MULTI-VALUED KEYWORDS SUCH AS RECFM.             310.
*                                                                         311.
*      FOR CONCATENATION, THE TEXT UNIT MUST CONTAIN A VARIABLE           312.
*      NUMBER OF VARIABLE LENGTH CHARACTER STRINGS SHOVED TOGETHER.       313.
*      IF A ',' OCCURS AFTER A VALUE,THEN THE NEXT VALUE IS SCANNED AND   314.
*      CONCATENATED TO THE CURRENT ONE. THIS ASSUMES THAT THE TEXT UNIT   315.
*      IS ONE FOR WHICH CONCATENATED STRINGS ARE REQUIRED. IT IS UP TO    316.
*      THE USER TO SUPPLY CORRECT DATA.                                   317.
*                                                                         318.
*      FOR THE SPECIAL KEYWORDS RECFM AND OPTCD, EACH LETTER OF THE       319.
*      VALUE IS INDIVIDUALLY LOOKED UP IN THE SUBTABLE AND THE VALUE      320.
*      THUS OBTAINED IS OR'ED WITH THE VALUE ALREADY IN THE TEXT UNIT.    321.
*      IE RECFM=FBA = X'80' | X'10' | X'04' = X'94'                       322.
*                                                                         323.
*   RETURN CODES AND DIAGNOSTICS:                                         324.
*      IF THE RETURN CODE FROM SVC99 IS NOT ZERO THEN A PARAMETER         325.
*      BLOCK FOR DAIRFAIL IS BUILT. DAIRFAIL IS CALLED AND THE            326.
*      DIAGNOSTIC THAT IT GENERATES IS WRITTEN TO THE JOB LOG (WTP).      327.
*                                                                         328.
*      THE INTERFACE ALSO HAS ITS OWN RETURNS CODES FOR ERRORS IS         329.
*      DETECTS IN THE USERS PARAMETER LIST. THESE START AT 4 HIGHER       330.
*      THAN THE RETURN CODES FROM SVC99.                                  331.
*                                                                         332.
*      THE RETURN CODE IS RETURNED BOTH IN REGISTER 15 AND IN THE         333.
*      SECOND WORD OF THE WORKAREA, IF IT STILL EXISTS AT THE END         334.
*      OF THE ROUTINE.                                                    335.
*                                                                         336.
*   SVC99 RETURN CODES (SEE SPL:JOB MANAGEMENT PAGE 34)                   337.
*      00 SUCCESSFULL COMPLETION                                          338.
*      04 ENVIRONMENT, RESOURCE FAILURE, SYSTEM ROUTINE                   339.
*      08 REQUEST DENIED BY INSTALLATION VALIDATION ROUTINE               340.
*      12 INVALID PARAMETER LIST                                          341.
*                                                                         342.
*   INTERFACE RETURN CODES                                                343.
*      16 INVALID VERB                                                    344.
*      20 INVALID KEYWORD                                                 345.
*      24 WORK AREA OVERFLOW                                              346.
*      28 VALUE NOT FOUND IN SUBTABLE: INVALID VALUE                      347.
*                                                                         348.
***********************************************************************   349.
         EJECT                                                            350.
WORKAREA DSECT                                                            351.
WALEN    DS    F                  LENGTH OF WORK AREA                     352.
WAS99RC  DS    A                  VALUE OF RETURN CODE FROM SVC 99        353.
WADWORD  DS    D                  DOUBLE WORD FOR PACKS                   354.
WABOTTOM DS    A                  END OF WORK AREA                        355.
WAKYSTRT DS    A                  START OF KEYWORD                        356.
WAVALAD  DS    A                  START OF VALUE                          357.
WAVBSTRT DS    A                  START OF VERB                           358.
WAS99RB  DS    A                  POINTER TO REQUEST BLOCK                359.
WADFID   DS    XL2                CALLER IDENTIFIER FOR DAIR FAIL         360.
WADFDSCT DS    A                  ADDR OF DSECT FOR CALLING DAIR FAIL     361.
WAZEROES DS    A                  ADDRESS OF IKJEFF02                     362.
WALASTTU DS    A                  ADDRESS OF END OF LAST TEXT UNIT        363.
WAALLOCR DS    XL1                IS THIS AN ALLOCR VERB                  364.
WATRUE   EQU   X'FF'                                                      365.
WASAVE   DS    18F                SAVE AREA FOR DAIRFAIL                  366.
WAEND    EQU   *                  END OF DSECT                            367.
         SPACE 1                                                          368.
VERBTABL DSECT                                                            369.
VTVLEN   DS    X                  LENGTH OF VERB                          370.
VTVERB   DS    X                  VERB CODE                               371.
VTVSTR   DS    0C                 VERB STRING                             372.
VTVEND   EQU   *                                                          373.
         SPACE 1                                                          374.
KYWDTABL DSECT                                                            375.
KYWDLEN  DS    X                  KEYWORD LENGTH                          376.
KYWDMIN  DS    X                  MINIMUM UNAMBIGOUS LENGTH               377.
KYWDPARM DS    X                  SPECIAL PARAMETER                       378.
KYNOPARM EQU   X'00'              FLAGS NO PARM                           379.
KYWDPMLN DS    X                  LENGTH OF PARM IF FIXED LENGTH          380.
KYWDKEY  DS    2X                 KEYWORD KEY                             381.
KYWDSTRG DS    0C                 KEYWORD STRING                          382.
         ORG   KYWDPARM                                                   383.
KYWDSUBT DS    X                  FLAG A SUBTABLE FOR THIS ENTRY          384.
KYWDSUBF EQU   X'F0'              FLAGS A SUBTABLE                        385.
         ORG                                                              386.
         SPACE 1                                                          387.
VALUTABL DSECT                                                            388.
VALULEN  DS    X                  LENGTH OF STRING IN THIS ENTRY          389.
VALUPARM DS    2X                 PARAMETER VALUE FOR TEXT UNIT           390.
VALUSTRG DS    0C                 ENTRY STRING                            391.
         SPACE 1                                                          392.
CHAR     DSECT                                                            393.
CH       DS    C                                                          394.
         EJECT                                                            395.
DICB1    DSECT                                                            396.
DIDDN    DS    XL14               DDNAME                                  397.
DIDSN    DS    XL50               DSNAME                                  398.
DIMEM    DS    XL14               MEMBER NAME                             399.
DISTAT   DS    XL7                STATUS                                  400.
DIDISP   DS    XL7                NORMAL DISPOSITION                      401.
DICDISP  DS    XL7                CONDITIONAL DISPOSITION                 402.
DIDSORG  DS    XL8                DSORG                                   403.
DILIMIT  DS    XL8                NUMBER RESOURCES TO BE FREED            404.
DIATTR   DS    XL7                ATTRIBUTE SPECIFICATION                 405.
DILAST   DS    XL7                LAST ENTRY SPECIFICATION                406.
DITYPE   DS    XL7                DATA SET TYPE (DUMMY,TERMINAL,OTHER)    407.
DILEN1   EQU   *-DICB1                                                    408.
DICB2    DSECT                                                            409.
DIDDN2   DS    XL14                                                       410.
DIDSN2   DS    XL50                                                       411.
DIDSORG2 DS    XL8                                                        412.
DIVOL2   DS    XL12                                                       413.
DILEN2   EQU   *-DICB2                                                    414.
         EJECT                                                            415.
         IEFZB4D0                                                         416.
         EJECT                                                            417.
         IEFZB4D2                                                         418.
         EJECT                                                            419.
         IKJEFFDF DFDSECT=YES                                             420.
         EJECT                                                            421.
@WA      EQU   11                 BASE ADDRESS FOR WORK AREA              422.
@RB      EQU   10                 BASE ADDRESS FOR REQUEST BLOCK          423.
@TP      EQU   9                  BASE ADDRESS FOR TEXT POINTERS          424.
@TU      EQU   8                  TEXT UNIT                               425.
@CH      EQU   7                  POINTER INTO PARM STRING                426.
@VTE     EQU   6                  VERB TABLE ENTRY                        427.
@KTE     EQU   6                  KEYWORD TABLE ENTRY                     428.
LENGTH   EQU   5                                                          429.
@DF      EQU   5                  BASE ADDRESS FOR DFDSECT                430.
         SPACE 1                                                          431.
DYNAM    CSECT                                                            432.
         USING DYNAM,12           ADDRESSIBILITY FOR CSECT                433.
         SAVE  (14,12),,DYNAM-MARCH-22-1979                               434.
         LR    R12,R15            GET BASE FOR CSECT                      435.
         SPACE 1                                                          436.
         USING WORKAREA,@WA       ADDRESSIBILITY FOR WORK AREA            437.
         USING S99RB,@RB          ADDRESSIBILITY FOR REQUEST BLOCK        438.
         USING S99TUPL,@TP        ADDRESSIBILITY FOR TEXT POINTERS        439.
         USING S99TUNIT,@TU       ADDRESSIBILITY FOR TEXT UNITS           440.
         USING CHAR,@CH                                                   441.
         USING VERBTABL,@VTE      ADDRESSIBILITY FOR VERB TABLE           442.
         USING DFDSECTD,@DF       ADDRESSIBILITY FOR DAIRFAIL DSECT       443.
         SPACE 1                                                          444.
*                                                                         445.
**   DECODE ENTRY OPTIONS                                                 446.
*                                                                         447.
         L     R2,4(R1)           ADDRESS OF VERB                         448.
         CLC   0(4,R2),=C'INIT'                                           449.
         BE    INITCODE                                                   450.
         CLC   0(3,R2),=C'END'                                            451.
         BE    ENDCODE                                                    452.
         L     @WA,0(R1)          ADDRESS OF WORK AREA                    453.
         OC    WALEN,WALEN        IS IT 0?                                454.
         BNZ   WORKGOT            NOPE                                    455.
         LR    R2,R1              SAVE R1                                 456.
         GETMAIN R,LV=2048                                                457.
         L     R3,0(R2)           ADDR OF PARM 1                          458.
         ST    R1,0(R3)           SAVE ADDRESS                            459.
         MVI   0(R3),X'0E'        MARK TO BE FREED AFTER ALLOCATE         460.
         L     @WA,0(R3)          GET ADDRESS                             461.
         LA    R3,2048            LENGTH OF WORKAREA                      462.
         ST    R3,WALEN           SET LENGTH                              463.
         LR    R1,R2              RESTORE R1                              464.
         B     WORKSET                                                    465.
WORKGOT  CLI   WALEN,X'0F'        IS THIS THE ADDRESS OF A WORK AREA?     466.
         BNE   WORKSET            NOPE, USER SUPPLIED AREA                467.
         L     @WA,WALEN          YES, DEREFENCE IT                       468.
WORKSET  DS    0H                                                         469.
*                                                                         470.
**   SET UP WORK AREA                                                     471.
*                                                                         472.
         L     @TP,WALEN          GET LENGTH                              473.
         LR    R2,@WA             ADDRESS OF WORK AREA                    474.
         LR    R3,@TP             LENGTH                                  475.
         LR    R4,R2              FROM ADDR FOR ZAP                       476.
         XR    R5,R5                                                      477.
         MVCL  R2,R4              ZAP WORK AREA                           478.
         LR    R15,R13            ADDR OF CALLERS SAVE                    479.
         LA    R13,WASAVE                                                 480.
         ST    R13,8(R15)         FORE LINK                               481.
         ST    R15,4(R13)         BACK LINK                               482.
         ST    @TP,WALEN                                                  483.
         AR    @TP,@WA            + ADDRESS = END OF WORK AREA            484.
         ST    @TP,WABOTTOM                                               485.
         LA    @RB,WAEND          BEGINNING OF REQUEST BLOCK              486.
         ST    @RB,WADFDSCT       ADDRESS OF DFDSECTD                     487.
         LA    @RB,DFLEN(@RB)     POINT PAST DFDSECTD                     488.
         ST    @RB,WAS99RB        ADDRESS OF REQUEST BLOCK                489.
         LA    @TU,S99RBEND       BEGINNING OF TEXT UNIT HEAP             490.
         MVI   S99RBLN,X'14'      LENGTH OF RB                            491.
*                                                                         492.
**  EXAMINE THE VERB PARAMETER                                            493.
*                                                                         494.
         L     @CH,4(R1)          GET SECOND PARM                         495.
         LA    @VTE,VERBTAB       FIRST ENTRY IN VERB TABLE               496.
         SR    R2,R2                                                      497.
VERBLOOP DS    0H                                                         498.
         C     @VTE,VERBTEND      END OF TABLE?                           499.
         BE    FAILVERB           YES, VERB NOT FOUND                     500.
         IC    R2,VTVLEN          GET LENGTH OF VERB                      501.
         BCTR  R2,0               LESS 1                                  502.
         EX    R2,VERBCLC         MATCH?                                  503.
         BE    VERBPOOL           YES                                     504.
         LA    @VTE,VTVSTR+1(R2)  GET NEXT ENTRY                          505.
         B     VERBLOOP                                                   506.
VERBCLC  CLC   VTVSTR,CH                                                  507.
VERBPOOL DS    0H                                                         508.
         CLC   CH(6),=C'ALLOCR'   VERB = ALLOCR?                          509.
         BNE   VERBEND                                                    510.
         MVI   WAALLOCR,WATRUE    SET ALLOCR FLAG                         511.
VERBEND  DS    0H                                                         512.
         MVC   S99VERB,VTVERB     MOVE IN VERB CODE                       513.
*                                                                         514.
*  SCAN OFF KEYWORD PARAMETERS.                                           515.
*                                                                         516.
         CLI   4(R1),X'80'        END OF PARM LIST?                       517.
         BE    FAILKEY                                                    518.
         LA    R1,8(R1)           POINT TO THIRD PARAMETER                519.
         CLI   S99VERB,S99VRBIN   VERB = INFO?                            520.
         BE    RETINFO            YUP                                     521.
         CLI   WAALLOCR,WATRUE    VERB = ALLOCR?                          522.
         BE    RETALLOC                                                   523.
         B     PARMLOOP           NOPE, START LOOP                        524.
*                                                                         525.
**   SET UP THE TEXT UNITS FOR DYNAMIC INFORMATION RETRIEVAL              526.
**   THIS IS FOR THE INFO AND ALLOCR VERBS                                527.
*                                                                         528.
RETINFO  DS    0H                                                         529.
         LA    R2,DILEN1(@TU)     POINT TO END OF DICB                    530.
         MVC   0(DILEN1,@TU),DICBS1 MOVE IN MODEL TEXT UNITS              531.
         B     RETLOOP                                                    532.
RETALLOC DS    0H                                                         533.
         LA    R2,DILEN2(@TU)     POINT TO END OF DICB2                   534.
         MVC   0(DILEN2,@TU),DICBS2 MOVE IN MODEL TEXT UNITS              535.
RETLOOP  DS    0H                                                         536.
         S     @TP,=F'4'          POINT TO TUPTR ENTRY                    537.
         ST    @TU,S99TUPTR       SET POINTER                             538.
         LH    R3,S99TULNG        GET LENGTH OF PARM FIELD                539.
         LA    @TU,S99TUPAR(R3)   POINT TO NEXT TEXT UNIT                 540.
         CR    @TU,R2             END OF DICB?                            541.
         BNE   RETLOOP                                                    542.
         CLI   0(R1),X'80'        LAST PARM?                              543.
         BE    PARMPOOL           YES                                     544.
         LA    R1,4(R1)           POINT TO NEXT PARM                      545.
PARMLOOP DS    0H                                                         546.
         L     @CH,0(R1)          GET ADDRESS OF STRING                   547.
         LA    @CH,0(@CH)         ZERO TOP BYTE                           548.
STRINGLP DS    0H                 START OF STRING LOOP                    549.
STRING01 DS    0H                                                         550.
         CLI   CH,C';'            END OF STRING                           551.
         BE    STRINGPL           YES, GOTO END OF STRING LOOP            552.
         CLI   CH,C','            COMMA?                                  553.
         BE    STRING02                                                   554.
         CLI   CH,C' '            BLANK?                                  555.
         BNE   STRING03                                                   556.
STRING02 LA    @CH,1(@CH)         GET NEXT CHAR                           557.
         B     STRING01                                                   558.
STRING03 DS    0H                                                         559.
         LA    R2,15             LENGTH OF LONGEST KEYWORD                560.
         ST    @CH,WAKYSTRT       SAVE START ADDRESS                      561.
KEYSLOOP DS    0H                                                         562.
         CLI   CH,C'='            END OF KEYWORD?                         563.
         BE    KEYSPOOL                                                   564.
         CLI   CH,C','                                                    565.
         BE    KEYSPOOL                                                   566.
         CLI   CH,C';'                                                    567.
         BE    KEYSPOOL                                                   568.
         CLI   CH,C' '                                                    569.
         BE    KEYSPOOL                                                   570.
         LA    @CH,1(@CH)         GET NEXT CHAR                           571.
         BCT   R2,KEYSLOOP                                                572.
         B     FAILKEY            KEY WORD FAILED                         573.
         USING KYWDTABL,@KTE      ADDRESSIBILITY FOR KEY WORD TABLE       574.
KEYSPOOL DS    0H                                                         575.
*                                                                         576.
** KEYWORD - SCAN OFF AND LOOK UP A KEYWORD                               577.
*                                                                         578.
KEYWORD  DS    0H                                                         579.
         L     R3,WAKYSTRT        GET FIRST CHR IN WORD                   580.
         CLI   0(R3),C'A'                                                 581.
         BL    FAILKEY            INVALID KEYWORD                         582.
         CLI   0(R3),C'Z'                                                 583.
         BH    FAILKEY            INVALID KEYWORD                         584.
         IC    R2,0(R3) GET FIRST CHAR                                    585.
         S     R2,=F'193'         SUBTRACT OFF VALUE OF 'A'               586.
         SLL   R2,2               TIMES 4                                 587.
         L     @KTE,KYWDINDX(R2)  GET ADDRESS OF FIRST ENTRY WITH         588.
*                                 SAME FIRST LETTER                       589.
         LR    LENGTH,@CH                                                 590.
         S     LENGTH,WAKYSTRT    LENGTH OF KEYWORD                       591.
         BCT   LENGTH,KEYLOOP     LESS ONE FOR EXECUTE                    592.
         B     FAILKEY                                                    593.
KEYLOOP  DS    0H                                                         594.
         CLC   KYWDSTRG(1),0(R3)  CHECK FIRST CHAR                        595.
         BNE   FAILKEY            NO LONGER IN CORRECT PART OF TABLE      596.
         EX    LENGTH,KEYCLC      COMPARE KEYWORD TO ENTRY                597.
         BE    KEYPOOL                                                    598.
         IC    R2,KYWDLEN         GET LENGTH OF ENTRY                     599.
         LA    @KTE,KYWDSTRG(R2)  GET NEXT ENTRY                          600.
         B     KEYLOOP                                                    601.
KEYCLC   CLC   KYWDSTRG,0(R3)                                             602.
KEYPOOL  DS    0H                                                         603.
         IC    R2,KYWDMIN         GET MIMINUM UNAMBIGOUS LENGTH           604.
         LA    LENGTH,1(LENGTH)   LENGTH :=+ 1                            605.
         CR    LENGTH,R2          CHECK LENGTH                            606.
         BL    FAILKEY            KEY WORD TOO SHORT                      607.
         MVC   S99TUKEY,KYWDKEY                                           608.
         LA    R4,S99TULNG        ADDRESS OF LENGTH FIELD                 609.
         ST    R4,WALASTTU        SAVE IT                                 610.
         CLI   CH,C'='            DID THE USER SUPPLY A PARM              611.
         BNE   SPECPARM           IF NOT, THEN PARM IS IN TABLE           612.
VALUNEXT DS    0H                                                         613.
         LA    @CH,1(@CH)         POINT PAST '='                          614.
         ST    @CH,WAVALAD                                                615.
VALULOOP DS    0H                                                         616.
         CLI   CH,C' '            BLANK?                                  617.
         BE    VALUPOOL           YES, END OF VALUE                       618.
         CLI   CH,C','            COMMA?                                  619.
         BE    VALUPOOL           YES, END OF VALUE                       620.
         CLI   CH,C';'            SEMI?                                   621.
         BE    VALUPOOL           YES, END OF VALUE                       622.
         LA    @CH,1(@CH)         GET NEXT VALUE                          623.
         B     VALULOOP                                                   624.
VALUPOOL DS    0H                                                         625.
         LR    LENGTH,@CH                                                 626.
         S     LENGTH,WAVALAD     LENGTH OF VALUE                         627.
         L     R4,WALASTTU                                                628.
         STH   LENGTH,0(R4)       SAVE LENGTH                             629.
         BCTR  LENGTH,0                                                   630.
         BM    TEXTNUM            DONT MOVE VALUE IF NULL                 631.
         L     R3,WAVALAD         GET START OF VALUE                      632.
         CLI   KYWDSUBT,KYWDSUBF  IS THERE A SUBTABLE?                    633.
         BNL   SUBTLKUP           YES                                     634.
         CLI   KYWDPMLN,KYNOPARM  IS THERE A LENGTH SUPPLIED?             635.
         BNE   CONVALUE                                                   636.
         L     R4,WALASTTU                                                637.
         LA    R4,2(R4)           POINT TO PARAMETER FIELD                638.
         EX    LENGTH,VALUEMVC                                            639.
         B     TEXTNUM                                                    640.
VALUEMVC MVC   R0(0,R4),0(R3)                                             641.
SUBTLKUP DS    0H                                                         642.
@SUBT    EQU   4                                                          643.
*                                                                         644.
**   R3 POINTS TO VALUE                                                   645.
**   R2 # OF ENTRIES IN SUBTABLE                                          646.
**   R15 USED FOR IC,STC                                                  647.
*                                                                         648.
         XR    R15,R15                                                    649.
         XR    R2,R2                                                      650.
         IC    R2,KYWDSUBT        GET SUBTABLE INDEX POINTER              651.
         N     R2,=F'15'          GET RID OF FLAG BITS                    652.
         SLL   R2,2               TIMES 4                                 653.
         L     @SUBT,VALUINDX(R2) ADDR OF SUBTABLE                        654.
         USING VALUTABL,@SUBT     ADDRESSIBILITY FOR SUBTABLE ENTRIES     655.
         IC    R2,VALUINDX(2)     # ENTRIES IN SUBTABLE                   656.
         CLC   KYWDSTRG(5),=C'RECFM' SPECIAL CASE FOR RECFM               657.
         BE    SPECCASE                                                   658.
         CLC   KYWDSTRG(5),=C'OPTCD' AND FOR OPTION CODE                  659.
         BE    SPECCASE                                                   660.
SUBTLOOP DS    0H                                                         661.
         EX    LENGTH,SUBTCLC     COMPARE ENTRIES                         662.
         BE    SUBTPOOL           ENTRY FOUND                             663.
         IC    R15,VALULEN        GET LENGTH OF THIS ENTRY                664.
         LA    @SUBT,VALUSTRG(R15) GET NEXT ENTRY                         665.
         BCT   R2,SUBTLOOP        REPEAT IF NOT AT END OF TABLE           666.
         B     FAILVALU                                                   667.
SUBTPOOL DS    0H                                                         668.
         LA    LENGTH,1(LENGTH)   LENGTH +:= 1                            669.
         CR    LENGTH,R15         CORRECT VALUE LENGTH                    670.
         BNE   FAILVALU                                                   671.
         IC    R2,KYWDPMLN        GET PARM LENGTH                         672.
         STC   R2,S99TULNG+1      SAVE IT IN TEXT UNIT                    673.
         IC    R2,CONVMASK(R2)    GET STCM MASK                           674.
         ICM   R3,3,VALUPARM      GET VALUE                               675.
         EX    R2,CONVSTCM        STCM R3,CONVMASK(R2),S99TUPAR           676.
         B     TEXTNUM                                                    677.
SUBTCLC  CLC   VALUSTRG,0(R3)                                             678.
*                                                                         679.
**   THIS CODE HANDLES THE SPECIAL CASE FOR KEYWORDS THAT CAN HAVE        680.
**   MORE THAN ONE VALUE SPECIFIED. EG 'RECFM=FBA'.                       681.
**   THE INDIVIDUAL VALUES ARE OR'ED TOGETHER                             682.
*                                                                         683.
SPECCASE DS    0H                                                         684.
         LR    R0,@SUBT           SAVE ADDR OF START OF SUBTABLE          685.
         LR    R15,R2             SAVE # SUBTABLE ENTRIES                 686.
         L     @CH,WAVALAD        POINT TO FIRST VALUE                    687.
         LA    LENGTH,1(LENGTH)   CORRECT LENGTH                          688.
SPECLOOP DS    0H                                                         689.
         CLC   CH,VALUSTRG        COMPARE CHAR WITH VALUE STRING          690.
         BE    SPECPOOL           FOUND                                   691.
         LA    @SUBT,VALUSTRG+1   NEXT ENTRY                              692.
         BCT   R2,SPECLOOP        REPEAT WITH NEW ENTRY                   693.
         B     FAILVALU           NO MORE ENTRIES LEFT                    694.
SPECPOOL DS    0H                                                         695.
         OC    S99TUPAR(1),VALUPARM+1                                     696.
         LA    @CH,CH+1           NEXT CHAR IN USER SUPPLIED VALUE        697.
         LR    @SUBT,R0           RESTORE SUBTABLE ADDR                   698.
         LR    R2,R15             RESTORE SUBTABLE ENTRY COUNT            699.
         BCT   LENGTH,SPECLOOP                                            700.
         MVC   S99TULNG+1(1),KYWDPMLN MOVE IN LENGTH                      701.
         B     TEXTNUM            FINISHED                                702.
*                                                                         703.
**   SUPPLY THE PARAMETER VALUE FOR THE TEXT UNIT FROM THE KEYWRD TABLE   704.
*                                                                         705.
SPECPARM DS    0H                                                         706.
         CLI   KYWDPARM,KYNOPARM  IS THERE A SPECIAL PARM?                707.
         BE    TEXTFINI                                                   708.
         MVC   S99TULNG+1(1),KYWDPMLN MOVE IN LENGTH                      709.
         MVC   S99TUPAR(1),KYWDPARM MOVE IN SPECIAL PARM                  710.
         B     TEXTNUM                                                    711.
*                                                                         712.
**   THE USER SUPPLIED VALUE IS TO BE CONVERTED TO BINARY AND RIGHT       713.
**   JUSTIFIED IN A FIELD WHOSE LENGTH IS SUPPLIED IN THE KEYWORD TABLE   714.
*                                                                         715.
CONVALUE DS    0H                                                         716.
         LA    R2,WADWORD-1+L'WADWORD POINT 1 BYTE BEFOR END OF WADWORD   717.
         SR    R2,LENGTH          POINT TO CORRECT ADDR FOR MVC           718.
         XC    WADWORD,WADWORD                                            719.
         EX    LENGTH,CONVMVC     MOVE VALUE                              720.
         PACK  WADWORD,WADWORD    CONVERT TO PACKED DECIMAL               721.
         CVB   R3,WADWORD         CONVERT TO BINARY                       722.
         MVC   S99TULNG+1(1),KYWDPMLN MOVE IN KYWDPARM                    723.
         XR    R2,R2                                                      724.
         IC    R2,S99TULNG+1      GET SPECIAL PARM                        725.
         IC    R2,CONVMASK(R2)    SET BYTE 2 FOR STCM INST                726.
         EX    R2,CONVSTCM        STCM R3,MASK(2),S99TUPAR                727.
         B     TEXTNUM                                                    728.
CONVMVC  MVC   0(0,R2),0(R3)                                              729.
CONVSTCM STCM  0,0,S99TUPAR                                               730.
CONVMASK DC    X'303133373F'                                              731.
*                                                                         732.
**   SET THE NUMBER FIELD IN THE TEXTUNIT                                 733.
*                                                                         734.
TEXTNUM  DS    0H                                                         735.
         LH    R2,S99TUNUM        NUMBER OF KEYS IN THIS TEXT UNIT        736.
         LA    R2,1(R2)           + ONE                                   737.
         STH   R2,S99TUNUM        SAVE IT                                 738.
         CLI   CH,C','            IS THERE ANOTHER PARAMETER?             739.
         BNE   TEXTFINI           NO                                      740.
         L     R4,WALASTTU        ADDRESF OF LENGTH FIELD FOR LAST TU     741.
         AH    R4,0(R4)           ADD LENGTH OF PARAMETER                 742.
         LA    R4,2(R4)           + 2 FOR LENGTH FIELD                    743.
         ST    R4,WALASTTU        = ADDRESS OF NEXT LENGTH FIELD          744.
         B     VALUNEXT           PROCESS NEXT VALUE                      745.
*                                                                         746.
**   COMLETE THE TEXT UNIT.                                               747.
**   CHECK FOR WAORK AREA OVERFLOW.                                       748.
**   ADD A NEW POINTER THE THE TEXTPOINTERS                               749.
*                                                                         750.
TEXTFINI DS    0H                                                         751.
         L     R2,WALASTTU        ADDRESS OF LENGTH FIELD                 752.
         AH    R2,0(2)            + LENGTH OF PARM                        753.
         LA    R2,2(2)            + TWO FOR LENGTH FIELD                  754.
         S     @TP,=F'4'          POINT TO NEW TEXT POINTER               755.
         CR    R2,@TP             CHECK FOR OVERFLOW                      756.
         BH    FAILOVFL           WORKAREA OVERFLOW                       757.
         ST    @TU,S99TUPTR       SAVE ADDR OF TU                         758.
         LR    @TU,R2             POINT TO NEW TEXT UNIT                  759.
         B     STRINGLP                                                   760.
STRINGPL DS    0H                 END OF STRING LOOP                      761.
         CLI   0(R1),X'80'        LAST PARM?                              762.
         BE    PARMPOOL           YES                                     763.
         LA    R1,4(R1)           POINT TO NEXT PARM                      764.
         B     PARMLOOP                                                   765.
PARMPOOL DS    0H                                                         766.
         EJECT                                                            767.
         ST    @TP,S99TXTPP       SET TEXT POINTER FIELD IN RB            768.
         L     @TP,WABOTTOM       GET END OF WORKAREA                     769.
         S     @TP,=F'4'          POINT TO LAST PARM                      770.
         MVI   S99TUPTR,S99TUPLN  SET LAST TP FLAG                        771.
         LA    R1,WAS99RB         GET ADDR OF REQUEST BLOCK               772.
         OI    0(R1),S99RBPND     TURN ON FIRST BIT OF S99RBP             773.
SVC99    DYNALLOC                 CALL DYNAMIC ALLOCATION RTN             774.
         LTR   R15,R15                                                    775.
         BNE   DAIRFAIL                                                   776.
         CLI   S99VERB,S99VRBIN   VERB = INFO?                            777.
         BE    INFODECO           YES, DECODE IT                          778.
         CLI   WAALLOCR,WATRUE    VERB = ALLOCR?                          779.
         BE    INFODECO                                                   780.
         B     RETURN                                                     781.
DAIRFAIL DS    0H                                                         782.
         L     @DF,WADFDSCT       ADDRESS OF DFDSECT                      783.
         ST    @RB,DFS99RBP       ADDRESS OF SVC99 REQUEST BLOCK          784.
         ST    R15,WAS99RC        SVC 99 RETURN CODE                      785.
         LA    R2,WAS99RC         GET ADDR OF IT                          786.
         ST    R2,DFRCP                                                   787.
         LA    R2,WADFID          ADDR OF DIFD                            788.
         ST    R2,DFIDP                                                   789.
         MVI   WADFID,DFWTP       SPECIFY WRITE TO PROGRAMMER             790.
         MVI   WADFID+1,DFSVC99   FROM SVC 99                             791.
         LA    R2,WAZEROES                                                792.
         ST    R2,DFJEFF02        ADDR OF ADDR OF IKJEFF02 (NOT KNOWN)    793.
         LR    R1,@DF                                                     794.
         LINK  EP=IKJEFF18        CALL DAIRFAIL                           795.
         L     R15,WAS99RC        RESTORE RETURN CODE                     796.
         B     RETURN                                                     797.
         EJECT                                                            798.
*                                                                         799.
**   INITIALIZATION CODE                                                  800.
*                                                                         801.
INITCODE DS    0H                                                         802.
         LR    R2,R1                                                      803.
         GETMAIN R,LV=2048        GETMAIN AREA                            804.
         L     R3,0(R2)           ADDRESS OF PARM ONE                     805.
         ST    R1,0(R3)           SAVE ADDRESS                            806.
         MVI   0(R3),X'0F'        INDICATE GETMAINED AREA                 807.
         L     R3,0(R3)           POINT TO AREA                           808.
         LA    R4,2048            LENGTH                                  809.
         ST    R4,0(R3)           SET LENGTH                              810.
         XR    R15,R15            SET RC                                  811.
         XC    4(4,R3),4(R3)      ZERO WAS99RC                            812.
         LM    R14,R12,12(R13)    RESTORE REGS                            813.
         XR    R15,R15            SET RETURN CODE                         814.
         XR    R0,R0                                                      815.
         BR    R14                RETURN                                  816.
ENDCODE  DS    0H                                                         817.
         LR    R2,R1              SAVE REG 1                              818.
         L     R3,0(R1)           ADDRESS OF PARM 1                       819.
         L     R3,0(R3)           ADDRESS TO BE FREED                     820.
         L     R4,0(R3)           LENGTH TO BE FREED                      821.
         FREEMAIN R,A=(3),LV=(4)                                          822.
         LM    R14,R12,12(R13)    RESTORE REGS                            823.
         XR    R15,R15            SET RETURN CODE                         824.
         XR    R0,R0                                                      825.
         BR    R14                RETURN                                  826.
         EJECT                                                            827.
*                                                                         828.
**   DECODE INFO RETURNED BY SVC99                                        829.
*                                                                         830.
INFODECO DS    0H                                                         831.
         L     R1,4(R13)                                                  832.
         L     R1,24(R1)          RECOVER R1                              833.
         L     R1,8(R1)           POINT TO THIRD PARM                     834.
         L     @TU,S99TUPTR       POINT TO FIRST TEXT UNIT                835.
         CLI   WAALLOCR,WATRUE    VERB = ALLOCR?                          836.
         BE    INFO1                                                      837.
         LA    R0,DILEN1(@TU)     POINT TO END OF DICB                    838.
         LA    R4,DICBS1          ADDRESS OF DICB MODEL                   839.
         B     INFO2                                                      840.
INFO1    DS    0H                                                         841.
         LA    R0,DILEN2(@TU)     POINT TO END OF DICB                    842.
         LA    R4,DICBS2          ADDRESS OF DICB MODEL                   843.
INFO2    DS    0H                                                         844.
INFOLOOP DS    0H                                                         845.
         LH    R3,S99TULNG        GET LENGTH                              846.
         BCTR  R3,0               LESS ONE FOR EXECUTE                    847.
         LTR   R3,R3                                                      848.
         BL    INFOLEN                                                    849.
         EX    R3,INFOMVC                                                 850.
INFOLEN  LH    R3,S99TULNG-S99TUNIT(,R4) GET MAX PARM LENGTH              851.
         AR    R1,R3              POINT TO NEXT INFO PARM                 852.
         LA    @TU,S99TUPAR(R3)   NEXT TEXT UNIT                          853.
         LA    R4,S99TUPAR-S99TUNIT(R3,4) NEXT TEXT UNIT IN MODEL         854.
         CR    @TU,R0             END OF INFO TU'S?                       855.
         BNE   INFOLOOP                                                   856.
         XR    R15,R15            SET RETURN CODE                         857.
         B     RETURN                                                     858.
INFOMVC  MVC   0(0,R1),S99TUPAR                                           859.
         SPACE 3                                                          860.
FAILVERB DS    0H                                                         861.
         LA    R15,16                                                     862.
         B     RETURN                                                     863.
FAILKEY  DS    0H                                                         864.
         LA    R15,20                                                     865.
         B     RETURN                                                     866.
FAILVALU DS    0H                                                         867.
         LA    R15,28                                                     868.
         B     RETURN                                                     869.
FAILOVFL DS    0H                                                         870.
         LA    R15,24                                                     871.
         B     RETURN                                                     872.
         EJECT                                                            873.
RETURN   DS    0H                                                         874.
         ST    R15,WAS99RC        RETURN CODE                             875.
         L     R13,4(R13)         RESTORE SAVEAREA ADDR                   876.
         ST    R15,16(R13)        SET RETURN CODE                         877.
         L     R1,24(R13)         RESTORE R1                              878.
         L     R1,0(R1)           ADDR OF PARM 1                          879.
         CLI   0(R1),X'0E'        IS AREA TO BE FREED?                    880.
         BNE   RETURN01                                                   881.
         LR    R2,R1              SAVE R1                                 882.
         L     R1,0(R1)           ADDR TO BE FREED                        883.
         FREEMAIN R,LV=2048,A=(1)                                         884.
         LR    R1,R2              RESTORE R1                              885.
         XC    0(4,R1),0(R1)      SET PARM 1 TO ZEROES                    886.
RETURN01 DS    0H                                                         887.
         LM    R14,R12,12(R13)    RESTORE REGS                            888.
         LR    R0,R15                                                     889.
         BR    R14                RETURN                                  890.
         EJECT                                                            891.
         PRINT NOGEN                                                      892.
         INDEX                                                            893.
VERBTAB  DS    0H                                                         894.
         VENT  ALLOC,S99VRBAL                                             895.
         VENT  ALLOCR,S99VRBAL                                            896.
         VENT  UNALLOC,S99VRBUN                                           897.
         VENT  CONCAT,S99VRBCC                                            898.
         VENT  UNCONCAT,S99VRBDC                                          899.
         VENT  REMOVE,S99VRBRI                                            900.
         VENT  DDALLOC,S99VRBDN                                           901.
         VENT  INFO,S99VRBIN                                              902.
VERBMARK DS    0X                                                         903.
VERBTEND DC    A(VERBMARK)                                                904.
         SPACE 1                                                          905.
KYWDTAB  DS    0H                                                         906.
         BEGIN A                                                          907.
         KENT  ABE,3,DALEROPT,20                                          908.
         KENT  ACC,3,DALEROPT,80                                          909.
         KENT  AL,2,DALLABEL,40                                           910.
         KENT  ALIGNMENT,3,DALFCBAV,08                                    911.
         KENT  ALX,3,DALSPFRM,02                                          912.
         KENT  AUL,3,DALLABEL,48                                          913.
         BEGIN B                                                          914.
         KENT  BLKSIZE,3,DALBLKSZ,,2                                      915.
         KENT  BLOCK,3,DALBLKLN,,3                                        916.
         KENT  BLP,3,DALLABEL,10                                          917.
         KENT  BUFALN,4,DALBFALN,SUBTABLE                                 918.
         KENT  BUFIN,4,DALBUFIN,,2                                        919.
         KENT  BUFL,4,DALBUFL,,2                                          920.
         KENT  BUFMAX,4,DALBUFMX,,1                                       921.
         KENT  BUFNO,4,DALBUFNO,,1                                        922.
         KENT  BUFOFF,5,DALBUFOF,,1                                       923.
         KENT  BUFOUT,5,DALBUFOU,,1                                       924.
         KENT  BUFRQ,4,DALBUFRQ,,1                                        925.
         KENT  BUFSZ,4,DALBUFSZ,,2                                        926.
         KENT  BUFTEK,4,DALBFTEK,SUBTABLE                                 927.
         BEGIN C                                                          928.
         KENT  CATLG,2,DALNDISP,02                                        929.
         KENT  CCATLG,2,DALCDISP,02                                       930.
         KENT  CDELETE,2,DALCDISP,04                                      931.
         KENT  CHARSET,2,DALUVRFY                                         932.
         KENT  CKEEP,2,DALCDISP,08                                        933.
         KENT  CLOSE,2,DALCLOSE                                           934.
         KENT  CODE,3,DALCODE,SUBTABLE                                    935.
         KENT  CONTIG,3,DALSPFRM,08                                       936.
         KENT  CONVERT,4,DALCNVRT                                         937.
         KENT  COPIES,3,DALCOPYS,,1                                       938.
         KENT  CUNCATLG,2,DALCDISP,01                                     939.
         KENT  CYL,2,DALCYL                                               940.
         BEGIN D                                                          941.
         KENT  DCBDD,5,DALDCBDD                                           942.
         KENT  DCBDS,5,DALDCBDS                                           943.
         KENT  DDNAME,2,DALDDNAM                                          944.
         KENT  DELETE,2,DALNDISP,04                                       945.
         KENT  DIRECTORY,2,DALDIR,,3                                      946.
         KENT  DSNAME,3,DALDSNAM                                          947.
         KENT  DSORG,3,DALDSORG,SUBTABLE,2                                948.
         KENT  DSSEQ,3,DALDSSEQ,,2                                        949.
         KENT  DUMMY,2,DALDUMMY                                           950.
         KENT  D1600,5,DALDEN,C3                                          951.
         KENT  D6250,5,DALDEN,D3                                          952.
         KENT  D800,4,DALDEN,83                                           953.
         BEGIN E                                                          954.
         KENT  EXPIRY,1,DALEXPDT                                          955.
         BEGIN F                                                          956.
         KENT  F,1,DALRECFM,80                                            957.
         KENT  FA,2,DALRECFM,84                                           958.
         KENT  FAS,3,DALRECFM,8C                                          959.
         KENT  FB,2,DALRECFM,C0                                           960.
         KENT  FBA,3,DALRECFM,C4                                          961.
         KENT  FBAS,4,DALRECFM,9C                                         962.
         KENT  FBM,3,DALRECFM,C2                                          963.
         KENT  FBMS,4,DALRECFM,8A                                         964.
         KENT  FBS,3,DALRECFM,98                                          965.
         KENT  FM,2,DALRECFM,82                                           966.
         KENT  FMS,3,DALRECFM,8A                                          967.
         KENT  FOLDMODE,3,DALUFOLD                                        968.
         KENT  FORMS,3,DALFCBIM                                           969.
         KENT  FS,2,DALRECFM,88                                           970.
         BEGIN G                                                          971.
         BEGIN H                                                          972.
         KENT  HOLD,1,DALSHOLD                                            973.
         BEGIN I                                                          974.
         KENT  INPUT,1,DALINOUT,40                                        975.
         BEGIN J                                                          976.
         BEGIN K                                                          977.
         KENT  KEEP,3,DALNDISP,08                                         978.
         KENT  KEYLEN,3,DALKYLEN,,1                                       979.
         BEGIN L                                                          980.
         KENT  LIMCT,2,DALLIMCT,,3                                        981.
         KENT  LRECL,2,DALLRECL,,2                                        982.
         KENT  LTM,2,DALLABEL,21                                          983.
         BEGIN M                                                          984.
         KENT  MEMBER,2,DALMEMBR                                          985.
         KENT  MOD,3,DALSTATS,02                                          986.
         KENT  MODE,4,DALMODE,SUBTABLE                                    987.
         KENT  MSVGP,2,DALMSVGP                                           988.
         KENT  MXIG,2,DALSPFRM,04                                         989.
         BEGIN N                                                          990.
         KENT  NCP,2,DALNCP,,1                                            991.
         KENT  NEW,3,DALSTATS,04                                          992.
         KENT  NEWCLASS,4,DUNOVCLS                                        993.
         KENT  NEWHOLD,4,DUNOVSHQ                                         994.
         KENT  NEWNOHOLD,4,DUNOVSNH                                       995.
         KENT  NEWREMOTE,4,DUNOVSUS                                       996.
         KENT  NL,2,DALLABEL,01                                           997.
         KENT  NSL,3,DALLABEL,04                                          998.
         BEGIN O                                                          999.
         KENT  OLD,3,DALSTATS,01                                         1000.
         KENT  OPTCD,2,DALOPTCD,SUBTABLE                                 1001.
         KENT  OUTLIM,4,DALOUTLM,,3                                      1002.
         KENT  OUTPUT,3,DALINOUT,80                                      1003.
         BEGIN P                                                         1004.
         KENT  PARALLEL,3,DALPARAL                                       1005.
         KENT  PASSREAD,5,DALPASPR,10                                    1006.
         KENT  PASSWORD,6,DALPASSW                                       1007.
         KENT  PASSWRITE,6,DALPASPR,30                                   1008.
         KENT  PERMANENT,2,DALPERMA                                      1009.
         KENT  PERMCONCAT,5,DCCPERMC                                     1009.1
         KENT  PRIMARY,4,DALPRIME,,3                                     1010.
         KENT  PRIVATE,4,DALPRIVT                                        1011.
         KENT  PRTSP,3,DALPRTSP,SUBTABLE                                 1012.
         BEGIN Q                                                         1013.
         KENT  QNAME,1,DALQNAME                                          1014.
         BEGIN R                                                         1015.
         KENT  RECFM,3,DALRECFM,SUBTABLE                                 1016.
         KENT  RELNO,3,DINRELNO,,2                                       1017.
         KENT  REMOTE,3,DALSUSER                                         1018.
         KENT  REMOVE,5,DUNREMOV                                         1019.
         KENT  RETENTION,3,DALRETPD,,2                                   1020.
         KENT  RLSE,2,DALRLSE                                            1021.
         KENT  ROUND,2,DALROUND                                          1022.
         BEGIN S                                                         1023.
         KENT  SECONDARY,3,DALSECND,,3                                   1024.
         KENT  SHR,2,DALSTATS,08                                         1025.
         KENT  SKP,2,DALEROPT,40                                         1026.
         KENT  SL,2,DALLABEL,02                                          1027.
         KENT  SUL,3,DALLABEL,08                                         1028.
         KENT  SYSOFORM,5,DALSFMNO                                       1029.
         KENT  SYSOPROG,5,DALSPGNM                                       1030.
         KENT  SYSOUT,5,DALSYSOU                                         1031.
         BEGIN T                                                         1032.
         KENT  TERMFILE,2,DALTERM                                        1033.
         KENT  TRK,3,DALTRK                                              1034.
         KENT  TRTCH,3,DALTRTCH,SUBTABLE                                 1035.
         BEGIN U                                                         1036.
         KENT  U,1,DALRECFM,C0                                           1037.
         KENT  UCS,2,DALUCS                                              1038.
         KENT  UNALLOC,3,DUNUNALC                                        1039.
         KENT  UNCATLG,3,DALNDISP,01                                     1040.
         KENT  UNICOUNT,4,DALUNCNT,,1                                    1041.
         KENT  UNIT,4,DALUNIT                                            1042.
         BEGIN V                                                         1043.
         KENT  V,1,DALRECFM,40                                           1044.
         KENT  VA,2,DALRECFM,44                                          1045.
         KENT  VAS,3,DALRECFM,4C                                         1046.
         KENT  VB,2,DALRECFM,50                                          1047.
         KENT  VBA,3,DALRECFM,64                                         1048.
         KENT  VBAS,4,DALRECFM,5C                                        1049.
         KENT  VBM,3,DALRECFM,62                                         1050.
         KENT  VBMS,4,DALRECFM,5A                                        1051.
         KENT  VBS,3,DALRECFM,58                                         1052.
         KENT  VERIFY,2,DALFCBAV,04                                      1053.
         KENT  VM,2,DALRECFM,42                                          1054.
         KENT  VMS,3,DALRECFM,4A                                         1055.
         KENT  VOLUME,3,DALVLSER                                         1056.
         KENT  VOLCOUNT,4,DALVLCNT,,1                                    1057.
         KENT  VOLREF,4,DALVLRDS                                         1058.
         KENT  VOLSEQ,4,DALVLSEQ,,2                                      1059.
         KENT  VS,2,DALRECFM,48                                          1060.
         BEGIN W                                                         1061.
         BEGIN X                                                         1062.
         BEGIN Y                                                         1063.
         BEGIN Z                                                         1064.
KYWDMARK DS    0X                                                        1065.
KYWDTEND DC    A(KYWDMARK)                                               1066.
         BEGINSUB BFALN           OFFSET 00                              1067.
         SENT  F,01                                                      1068.
         SENT  D,02                                                      1069.
         BEGINSUB BFTEK           OFFSET 04                              1070.
         SENT  D,08                                                      1071.
         SENT  E,10                                                      1072.
         SENT  R,20                                                      1073.
         SENT  S,40                                                      1074.
         SENT  A,60                                                      1075.
         BEGINSUB CODE                                                   1076.
         SENT  T,02                                                      1077.
         SENT  A,04                                                      1078.
         SENT  C,08                                                      1079.
         SENT  B,10                                                      1080.
         SENT  F,20                                                      1081.
         SENT  I,40                                                      1082.
         SENT  N,80                                                      1083.
         BEGINSUB DSORG                                                  1084.
         SENT  TQ,0020                                                   1085.
         SENT  TX,0040                                                   1086.
         SENT  GS,0080                                                   1087.
         SENT  PO,0200                                                   1088.
         SENT  MQ,0400                                                   1089.
         SENT  CQ,0800                                                   1090.
         SENT  CX,1000                                                   1091.
         SENT  DA,2000                                                   1092.
         SENT  PS,4000                                                   1093.
         SENT  POU,0300                                                  1094.
         SENT  DAU,2100                                                  1095.
         SENT  PSU,4100                                                  1096.
         SENT  TCAM,0004                                                 1097.
         SENT  VSAM,0008                                                 1098.
         BEGINSUB MODE                                                   1099.
         SENT  E,40                                                      1100.
         SENT  C,80                                                      1101.
         SENT  ER,50                                                     1102.
         SENT  EO,60                                                     1103.
         SENT  CR,90                                                     1104.
         SENT  CO,A0                                                     1105.
         BEGINSUB OPTCD           OFFSET 04                              1106.
         SENT  R,01                                                      1107.
         SENT  T,02                                                      1108.
         SENT  Z,04                                                      1109.
         SENT  A,08                                                      1110.
         SENT  Q,08                                                      1111.
         SENT  F,10                                                      1112.
         SENT  H,10                                                      1113.
         SENT  O,10                                                      1114.
         SENT  C,20                                                      1115.
         SENT  E,20                                                      1116.
         SENT  B,40                                                      1117.
         SENT  U,40                                                      1118.
         SENT  W,80                                                      1119.
         BEGINSUB PRTSP                                                  1120.
         SENT  0,01                                                      1121.
         SENT  1,09                                                      1122.
         SENT  2,11                                                      1123.
         SENT  3,19                                                      1124.
         BEGINSUB RECFM                                                  1125.
         SENT  M,02                                                      1126.
         SENT  R,02                                                      1127.
         SENT  A,04                                                      1128.
         SENT  G,04                                                      1129.
         SENT  S,08                                                      1130.
         SENT  B,10                                                      1131.
         SENT  D,20                                                      1132.
         SENT  T,20                                                      1133.
         SENT  V,40                                                      1134.
         SENT  F,80                                                      1135.
         SENT  U,C0                                                      1136.
         BEGINSUB TRTCH                                                  1137.
         SENT  C,13                                                      1138.
         SENT  E,23                                                      1139.
         SENT  T,3B                                                      1140.
         SENT  ET,2B                                                     1141.
         ENDSUB                                                          1142.
VALUINDX SUBINDEX                                                        1143.
DICBS1   DICBTAB1                                                        1144.
DICBS2   DICBTAB2                                                        1145.
R0       EQU   0                                                         1146.
R1       EQU   1                                                         1147.
R2       EQU   2                                                         1148.
R3       EQU   3                                                         1149.
R4       EQU   4                                                         1150.
R5       EQU   5                                                         1151.
R6       EQU   6                                                         1152.
R7       EQU   7                                                         1153.
R8       EQU   8                                                         1154.
R9       EQU   9                                                         1155.
R10      EQU   10                                                        1156.
R11      EQU   11                                                        1157.
R12      EQU   12                                                        1158.
R13      EQU   13                                                        1159.
R14      EQU   14                                                        1160.
R15      EQU   15                                                        1161.
         END                                                             1162.
